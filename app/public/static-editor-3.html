<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Static Editor - Page 3 | CrewArmy</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        slate: {
                            900: '#0f172a',
                            800: '#1e293b',
                            700: '#334155',
                            600: '#475569',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
        }
    </style>
</head>
<body class="text-white">
    <div class="min-h-screen p-4">
        <div class="max-w-7xl mx-auto">
            <!-- Header -->
            <div class="flex justify-between items-center mb-8">
                <div class="flex items-center gap-4">
                    <h1 class="text-3xl font-bold">üåê Static Editor - Page 3</h1>
                </div>
                <div class="flex gap-4">
                    <button onclick="saveContent()" class="bg-green-600 hover:bg-green-700 px-4 py-2 rounded flex items-center gap-2">
                        üíæ Save & Push
                    </button>
                    <a href="https://multinat.github.io/CrewArmy/pages/3/" target="_blank" 
                       class="bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded flex items-center gap-2">
                        üëÅÔ∏è Preview
                    </a>
                </div>
            </div>

            <!-- Status Alert -->
            <div id="statusAlert" class="mb-6 p-4 bg-blue-500/10 border border-blue-500/30 rounded-lg hidden">
                <div id="statusMessage" class="text-blue-400"></div>
            </div>

            <!-- Token Input - Only shown when no token -->
            <div id="tokenSection" class="mb-6 p-4 bg-yellow-500/10 border border-yellow-500/30 rounded-lg">
                <h3 class="text-yellow-400 font-bold mb-2">üîë Enter Token</h3>
                <div class="flex gap-3 items-end">
                    <input type="password" id="githubToken" placeholder="Paste access token here..." 
                           class="flex-1 bg-slate-800 border border-slate-600 rounded px-3 py-2 text-white">
                    <button onclick="setTokenAndLoad()" 
                            class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded font-semibold">
                        Load
                    </button>
                </div>
            </div>
            
            <!-- Content Loaded Section - Hidden initially -->
            <div id="contentSection" class="mb-6 p-4 bg-green-500/10 border border-green-500/30 rounded-lg hidden">
                <div class="flex justify-between items-center">
                    <h3 class="text-green-400 font-bold">‚úÖ Ready to Edit</h3>
                    <button onclick="resetToken()" 
                            class="text-gray-400 hover:text-gray-300 text-sm underline">
                        Change Token
                    </button>
                </div>
            </div>

            <!-- Page Title Editor -->
            <div class="mb-8 p-6 bg-gray-800/60 rounded-xl border-l-4 border-blue-400">
                <div class="flex items-center gap-3 mb-4">
                    <span class="text-2xl">üìÑ</span>
                    <h2 class="text-xl font-bold text-blue-400">PAGE TITLE</h2>
                </div>
                <textarea 
                    id="pageTitle"
                    onchange="updatePageTitle(this.value)"
                    oninput="autoResize(this)"
                    class="w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white text-lg font-bold leading-tight resize-none overflow-hidden"
                    rows="1"
                    style="min-height: 40px; line-height: 1.2;"
                    placeholder="Enter page title..."></textarea>
            </div>

            <!-- Frontline Responsibilities Section -->
            <div class="mb-8">
                <h2 class="text-xl font-bold text-yellow-400 mb-6 flex items-center gap-2">
                    üë• FRONTLINE RESPONSIBILITIES
                </h2>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Main Responsibilities -->
                    <div class="bg-gray-800/60 rounded-xl p-6 border-l-4 border-yellow-400">
                        <div class="flex items-center gap-3 mb-4">
                            <span class="text-2xl">üë•</span>
                            <h3 class="text-lg font-bold text-yellow-400">RESPONSIBILITIES TITLE</h3>
                        </div>
                        <input type="text" id="frontlineTitle" onchange="updateFrontlineTitle(this.value)"
                               class="w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white mb-3"
                               placeholder="Frontline title...">
                        <div id="frontlineItems" class="space-y-3">
                            <!-- Frontline items will be loaded here -->
                        </div>
                        <button onclick="addItem('frontline')" class="mt-3 text-yellow-400 hover:text-yellow-300 flex items-center gap-1.5 text-sm">
                            ‚ûï Add Responsibility
                        </button>
                    </div>

                    <!-- Success Metrics -->
                    <div class="bg-gray-800/60 rounded-xl p-6 border-l-4 border-green-400">
                        <div class="flex items-center gap-3 mb-4">
                            <span class="text-2xl">üìä</span>
                            <h3 class="text-lg font-bold text-green-400">SUCCESS METRICS</h3>
                        </div>
                        <input type="text" id="metricsTitle" onchange="updateMetricsTitle(this.value)"
                               class="w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white mb-3"
                               placeholder="Metrics title...">
                        <div id="metricsItems" class="space-y-3">
                            <!-- Metrics items will be loaded here -->
                        </div>
                        <button onclick="addItem('metrics')" class="mt-3 text-green-400 hover:text-green-300 flex items-center gap-1.5 text-sm">
                            ‚ûï Add Metric
                        </button>
                    </div>
                </div>
            </div>

            <!-- Operator Actions Section -->
            <div class="mb-8">
                <h2 class="text-xl font-bold text-blue-400 mb-6 flex items-center gap-2">
                    üîß SPECIFIC OPERATOR ACTIONS
                </h2>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Equipment & Tools -->
                    <div class="bg-gray-700/50 rounded-xl p-6 border-l-4 border-orange-400">
                        <div class="flex items-center gap-3 mb-4">
                            <span class="text-2xl">üîß</span>
                            <h3 class="text-base font-bold text-orange-400">EQUIPMENT & TOOLS</h3>
                        </div>
                        <input type="text" id="equipmentTitle" onchange="updateSectionTitle('equipment', this.value)"
                               class="w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white mb-3"
                               placeholder="Equipment title...">
                        <textarea id="equipmentContent" onchange="updateSectionContent('equipment', this.value)"
                                  oninput="autoResize(this)"
                                  class="w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white text-sm leading-tight resize-none"
                                  rows="3"
                                  placeholder="Equipment content..."></textarea>
                    </div>

                    <!-- Chemical Handling -->
                    <div class="bg-gray-700/50 rounded-xl p-6 border-l-4 border-red-400">
                        <div class="flex items-center gap-3 mb-4">
                            <span class="text-2xl">üß™</span>
                            <h3 class="text-base font-bold text-red-400">CHEMICAL HANDLING</h3>
                        </div>
                        <input type="text" id="chemicalTitle" onchange="updateSectionTitle('chemical', this.value)"
                               class="w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white mb-3"
                               placeholder="Chemical title...">
                        <textarea id="chemicalContent" onchange="updateSectionContent('chemical', this.value)"
                                  oninput="autoResize(this)"
                                  class="w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white text-sm leading-tight resize-none"
                                  rows="3"
                                  placeholder="Chemical content..."></textarea>
                    </div>

                    <!-- Machinery Operations -->
                    <div class="bg-gray-700/50 rounded-xl p-6 border-l-4 border-blue-400">
                        <div class="flex items-center gap-3 mb-4">
                            <span class="text-2xl">‚öôÔ∏è</span>
                            <h3 class="text-base font-bold text-blue-400">MACHINERY OPERATIONS</h3>
                        </div>
                        <input type="text" id="machineryTitle" onchange="updateSectionTitle('machinery', this.value)"
                               class="w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white mb-3"
                               placeholder="Machinery title...">
                        <textarea id="machineryContent" onchange="updateSectionContent('machinery', this.value)"
                                  oninput="autoResize(this)"
                                  class="w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white text-sm leading-tight resize-none"
                                  rows="3"
                                  placeholder="Machinery content..."></textarea>
                    </div>

                    <!-- Emergency Response -->
                    <div class="bg-gray-700/50 rounded-xl p-6 border-l-4 border-yellow-400">
                        <div class="flex items-center gap-3 mb-4">
                            <span class="text-2xl">üö®</span>
                            <h3 class="text-base font-bold text-yellow-400">EMERGENCY RESPONSE</h3>
                        </div>
                        <input type="text" id="emergencyTitle" onchange="updateSectionTitle('emergency', this.value)"
                               class="w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white mb-3"
                               placeholder="Emergency title...">
                        <textarea id="emergencyContent" onchange="updateSectionContent('emergency', this.value)"
                                  oninput="autoResize(this)"
                                  class="w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white text-sm leading-tight resize-none"
                                  rows="3"
                                  placeholder="Emergency content..."></textarea>
                    </div>

                    <!-- Communication -->
                    <div class="bg-gray-700/50 rounded-xl p-6 border-l-4 border-green-400">
                        <div class="flex items-center gap-3 mb-4">
                            <span class="text-2xl">üì¢</span>
                            <h3 class="text-base font-bold text-green-400">COMMUNICATION</h3>
                        </div>
                        <input type="text" id="communicationTitle" onchange="updateSectionTitle('communication', this.value)"
                               class="w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white mb-3"
                               placeholder="Communication title...">
                        <textarea id="communicationContent" onchange="updateSectionContent('communication', this.value)"
                                  oninput="autoResize(this)"
                                  class="w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white text-sm leading-tight resize-none"
                                  rows="3"
                                  placeholder="Communication content..."></textarea>
                    </div>

                    <!-- Leadership & Supervision -->
                    <div class="bg-gray-700/50 rounded-xl p-6 border-l-4 border-purple-400">
                        <div class="flex items-center gap-3 mb-4">
                            <span class="text-2xl">üë®‚Äçüíº</span>
                            <h3 class="text-base font-bold text-purple-400">LEADERSHIP & SUPERVISION</h3>
                        </div>
                        <input type="text" id="leadershipTitle" onchange="updateSectionTitle('leadership', this.value)"
                               class="w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white mb-3"
                               placeholder="Leadership title...">
                        <textarea id="leadershipContent" onchange="updateSectionContent('leadership', this.value)"
                                  oninput="autoResize(this)"
                                  class="w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white text-sm leading-tight resize-none"
                                  rows="3"
                                  placeholder="Leadership content..."></textarea>
                    </div>
                </div>

                <!-- Focus Areas & Stop Work -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mt-6">
                    <!-- Focus Areas -->
                    <div class="bg-gray-700/50 rounded-xl p-6 border-l-4 border-cyan-400">
                        <div class="flex items-center gap-3 mb-4">
                            <span class="text-2xl">üéØ</span>
                            <h3 class="text-base font-bold text-cyan-400">FOCUS AREAS</h3>
                        </div>
                        <input type="text" id="focusTitle" onchange="updateFocusTitle(this.value)"
                               class="w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white mb-3"
                               placeholder="Focus areas title...">
                        <textarea id="focusContent" onchange="updateFocusContent(this.value)"
                                  oninput="autoResize(this)"
                                  class="w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white text-sm leading-tight resize-none"
                                  rows="3"
                                  placeholder="Focus areas content..."></textarea>
                    </div>

                    <!-- Stop Work Authority -->
                    <div class="bg-gray-700/50 rounded-xl p-6 border-l-4 border-red-400">
                        <div class="flex items-center gap-3 mb-4">
                            <span class="text-2xl">üõë</span>
                            <h3 class="text-base font-bold text-red-400">STOP WORK AUTHORITY</h3>
                        </div>
                        <input type="text" id="stopWorkTitle" onchange="updateStopWorkTitle(this.value)"
                               class="w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white mb-3"
                               placeholder="Stop work title...">
                        <textarea id="stopWorkSubtitle" onchange="updateStopWorkSubtitle(this.value)"
                                  oninput="autoResize(this)"
                                  class="w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white text-sm leading-tight resize-none"
                                  rows="2"
                                  placeholder="Stop work subtitle..."></textarea>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div class="mb-8 p-6 bg-gray-800/60 rounded-xl border-l-4 border-gray-400">
                <div class="flex items-center gap-3 mb-4">
                    <span class="text-2xl">üìÑ</span>
                    <h2 class="text-xl font-bold text-gray-400">FOOTER</h2>
                </div>
                <input type="text" id="pageFooter" onchange="updatePageFooter(this.value)"
                       class="w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white"
                       placeholder="Enter footer text...">
            </div>

            <!-- Instructions -->
            <div class="mt-8 p-6 bg-gray-800/30 rounded-xl">
                <h3 class="text-xl font-bold text-blue-400 mb-4">üìã How to Use</h3>
                <ol class="list-decimal list-inside space-y-2 text-gray-300">
                    <li>Enter your token and click "Load"</li>
                    <li>Edit text in any section below</li>
                    <li>Add new items with ‚ûï buttons</li>
                    <li>Click "Save & Push" to update</li>
                    <li>View changes on live site (5-10 minutes)</li>
                </ol>
            </div>
        </div>
    </div>

    <script>
        let currentContent = null;
        let savedToken = null;

        function showStatus(message, type = 'info') {
            const alert = document.getElementById('statusAlert');
            const messageEl = document.getElementById('statusMessage');
            messageEl.textContent = message;
            
            alert.classList.remove('hidden', 'bg-blue-500/10', 'border-blue-500/30', 'bg-green-500/10', 'border-green-500/30', 'bg-red-500/10', 'border-red-500/30');
            messageEl.classList.remove('text-blue-400', 'text-green-400', 'text-red-400');
            
            if (type === 'success') {
                alert.classList.add('bg-green-500/10', 'border-green-500/30');
                messageEl.classList.add('text-green-400');
            } else if (type === 'error') {
                alert.classList.add('bg-red-500/10', 'border-red-500/30');
                messageEl.classList.add('text-red-400');
            } else {
                alert.classList.add('bg-blue-500/10', 'border-blue-500/30');
                messageEl.classList.add('text-blue-400');
            }
            
            alert.classList.remove('hidden');
            
            setTimeout(() => {
                alert.classList.add('hidden');
            }, 5000);
        }

        function setTokenAndLoad() {
            const token = document.getElementById('githubToken').value.trim();
            if (!token) {
                showStatus('Please enter a token first!', 'error');
                return;
            }
            
            savedToken = token;
            localStorage.setItem('editorToken', token);
            
            // Hide token section, show content section
            document.getElementById('tokenSection').classList.add('hidden');
            document.getElementById('contentSection').classList.remove('hidden');
            
            loadContent();
        }
        
        function resetToken() {
            savedToken = null;
            localStorage.removeItem('editorToken');
            document.getElementById('githubToken').value = '';
            document.getElementById('tokenSection').classList.remove('hidden');
            document.getElementById('contentSection').classList.add('hidden');
            currentContent = null;
            
            // Clear editor content
            ['frontlineItems', 'metricsItems'].forEach(id => {
                const element = document.getElementById(id);
                if (element) element.innerHTML = '';
            });
        }
        
        // Check for saved token on page load
        window.addEventListener('load', function() {
            const savedTokenFromStorage = localStorage.getItem('editorToken');
            if (savedTokenFromStorage) {
                savedToken = savedTokenFromStorage;
                document.getElementById('githubToken').value = savedTokenFromStorage;
                setTokenAndLoad();
            }
        });

        async function loadContent() {
            const token = savedToken || document.getElementById('githubToken').value;
            if (!token) {
                showStatus('Please enter your token first!', 'error');
                return;
            }

            showStatus('Loading content...');
            
            try {
                const response = await fetch('https://api.github.com/repos/Multinat/CrewArmy/contents/app/lib/slide-content.json', {
                    headers: {
                        'Authorization': `token ${token}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });

                if (!response.ok) {
                    throw new Error(`API error: ${response.status}`);
                }

                const data = await response.json();
                const content = JSON.parse(atob(data.content));
                currentContent = content;

                // Populate the editor with content
                populateEditor(content.slide3);
                showStatus('‚úÖ Content loaded successfully!', 'success');
                
            } catch (error) {
                showStatus(`Error loading content: ${error.message}`, 'error');
            }
        }

        function populateEditor(slide3) {
            // Populate Page Title & Footer
            if (slide3.title) document.getElementById('pageTitle').value = slide3.title;
            if (slide3.footer) document.getElementById('pageFooter').value = slide3.footer;
            
            // Populate Frontline Responsibilities
            if (slide3.frontlineResponsibilities) {
                document.getElementById('frontlineTitle').value = slide3.frontlineResponsibilities.title || '';
                document.getElementById('metricsTitle').value = slide3.frontlineResponsibilities.successMetrics?.title || '';
                
                populateSection('frontlineItems', slide3.frontlineResponsibilities.items || [], 'frontline');
                populateSection('metricsItems', slide3.frontlineResponsibilities.successMetrics?.items || [], 'metrics');
            }
            
            // Populate Operator Actions Sections
            if (slide3.operatorActions?.sections) {
                const sections = slide3.operatorActions.sections;
                const sectionMap = {
                    'EQUIPMENT & TOOLS': 'equipment',
                    'CHEMICAL HANDLING': 'chemical',
                    'MACHINERY OPERATIONS': 'machinery',
                    'EMERGENCY RESPONSE': 'emergency',
                    'COMMUNICATION': 'communication',
                    'LEADERSHIP & SUPERVISION': 'leadership'
                };
                
                sections.forEach(section => {
                    const key = sectionMap[section.title];
                    if (key) {
                        document.getElementById(`${key}Title`).value = section.title;
                        document.getElementById(`${key}Content`).value = section.content;
                        autoResize(document.getElementById(`${key}Content`));
                    }
                });
            }
            
            // Populate Focus Areas and Stop Work
            if (slide3.operatorActions?.focusAreas) {
                document.getElementById('focusTitle').value = slide3.operatorActions.focusAreas.title || '';
                document.getElementById('focusContent').value = slide3.operatorActions.focusAreas.content || '';
            }
            
            if (slide3.operatorActions?.stopWork) {
                document.getElementById('stopWorkTitle').value = slide3.operatorActions.stopWork.title || '';
                document.getElementById('stopWorkSubtitle').value = slide3.operatorActions.stopWork.subtitle || '';
            }
        }

        function populateSection(containerId, items, section) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            items.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = 'flex items-start gap-2';
                div.innerHTML = `
                    <div class="w-2 h-2 bg-current rounded-full mt-2 opacity-60"></div>
                    <textarea 
                           onchange="updateItem('${section}', ${index}, this.value)"
                           oninput="autoResize(this)"
                           class="flex-1 bg-slate-700 border border-slate-600 rounded px-2 py-1.5 text-white text-xs leading-tight resize-none overflow-hidden"
                           rows="1"
                           style="min-height: 24px; line-height: 1.2;"
                           placeholder="Enter item...">${item}</textarea>
                    <button onclick="removeItem('${section}', ${index})" 
                            class="text-red-400 hover:text-red-300 px-1.5 py-1 rounded text-xs"
                            title="Remove item">üóëÔ∏è</button>
                `;
                container.appendChild(div);
            });
        }

        function updatePageTitle(value) {
            if (!currentContent) return;
            currentContent.slide3.title = value;
        }

        function updatePageFooter(value) {
            if (!currentContent) return;
            currentContent.slide3.footer = value;
        }

        function updateFrontlineTitle(value) {
            if (!currentContent) return;
            currentContent.slide3.frontlineResponsibilities.title = value;
        }

        function updateMetricsTitle(value) {
            if (!currentContent) return;
            currentContent.slide3.frontlineResponsibilities.successMetrics.title = value;
        }

        function updateSectionTitle(sectionKey, value) {
            if (!currentContent) return;
            
            const sectionMap = {
                'equipment': 'EQUIPMENT & TOOLS',
                'chemical': 'CHEMICAL HANDLING',
                'machinery': 'MACHINERY OPERATIONS',
                'emergency': 'EMERGENCY RESPONSE',
                'communication': 'COMMUNICATION',
                'leadership': 'LEADERSHIP & SUPERVISION'
            };
            
            const targetTitle = sectionMap[sectionKey];
            const section = currentContent.slide3.operatorActions.sections.find(s => s.title === targetTitle);
            if (section) {
                section.title = value;
            }
        }

        function updateSectionContent(sectionKey, value) {
            if (!currentContent) return;
            
            const sectionMap = {
                'equipment': 'EQUIPMENT & TOOLS',
                'chemical': 'CHEMICAL HANDLING',
                'machinery': 'MACHINERY OPERATIONS',
                'emergency': 'EMERGENCY RESPONSE',
                'communication': 'COMMUNICATION',
                'leadership': 'LEADERSHIP & SUPERVISION'
            };
            
            const targetTitle = sectionMap[sectionKey];
            const section = currentContent.slide3.operatorActions.sections.find(s => s.title === targetTitle);
            if (section) {
                section.content = value;
            }
        }

        function updateFocusTitle(value) {
            if (!currentContent) return;
            currentContent.slide3.operatorActions.focusAreas.title = value;
        }

        function updateFocusContent(value) {
            if (!currentContent) return;
            currentContent.slide3.operatorActions.focusAreas.content = value;
        }

        function updateStopWorkTitle(value) {
            if (!currentContent) return;
            currentContent.slide3.operatorActions.stopWork.title = value;
        }

        function updateStopWorkSubtitle(value) {
            if (!currentContent) return;
            currentContent.slide3.operatorActions.stopWork.subtitle = value;
        }

        function updateItem(section, index, value) {
            if (!currentContent) return;
            
            if (section === 'frontline') {
                currentContent.slide3.frontlineResponsibilities.items[index] = value;
            } else if (section === 'metrics') {
                currentContent.slide3.frontlineResponsibilities.successMetrics.items[index] = value;
            }
        }

        function addItem(section) {
            if (!currentContent) {
                showStatus('Please load content first!', 'error');
                return;
            }
            
            if (section === 'frontline') {
                currentContent.slide3.frontlineResponsibilities.items.push('New responsibility');
                populateSection('frontlineItems', currentContent.slide3.frontlineResponsibilities.items, 'frontline');
            } else if (section === 'metrics') {
                currentContent.slide3.frontlineResponsibilities.successMetrics.items.push('New metric');
                populateSection('metricsItems', currentContent.slide3.frontlineResponsibilities.successMetrics.items, 'metrics');
            }
        }

        function removeItem(section, index) {
            if (!currentContent) return;
            
            if (section === 'frontline') {
                currentContent.slide3.frontlineResponsibilities.items.splice(index, 1);
                populateSection('frontlineItems', currentContent.slide3.frontlineResponsibilities.items, 'frontline');
            } else if (section === 'metrics') {
                currentContent.slide3.frontlineResponsibilities.successMetrics.items.splice(index, 1);
                populateSection('metricsItems', currentContent.slide3.frontlineResponsibilities.successMetrics.items, 'metrics');
            }
        }

        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.max(24, textarea.scrollHeight) + 'px';
        }

        async function saveContent() {
            const token = savedToken || document.getElementById('githubToken').value;
            if (!token || !currentContent) {
                showStatus('Please enter token and load content first!', 'error');
                return;
            }

            showStatus('Saving and pushing changes...');

            try {
                // Get current file to get its SHA
                const getResponse = await fetch('https://api.github.com/repos/Multinat/CrewArmy/contents/app/lib/slide-content.json', {
                    headers: {
                        'Authorization': `token ${token}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });

                const currentFile = await getResponse.json();
                
                // Update the file
                const updateResponse = await fetch('https://api.github.com/repos/Multinat/CrewArmy/contents/app/lib/slide-content.json', {
                    method: 'PUT',
                    headers: {
                        'Authorization': `token ${token}`,
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        message: `Update Page 3 content via static editor\n\n- Updated via static editor\n- Timestamp: ${new Date().toISOString()}`,
                        content: btoa(JSON.stringify(currentContent, null, 2)),
                        sha: currentFile.sha
                    })
                });

                if (updateResponse.ok) {
                    showStatus('‚úÖ Content saved and pushed successfully!', 'success');
                } else {
                    throw new Error(`Failed to update: ${updateResponse.status}`);
                }

            } catch (error) {
                showStatus(`Error saving: ${error.message}`, 'error');
            }
        }
    </script>
</body>
</html>
